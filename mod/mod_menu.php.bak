<?php

	// s&eacute;curit&eacute;
	defined('JL') or die('Error 401');

	global $user, $app, $action, $langue, $db;
	include("lang/app_mod.".$_GET['lang'].".php");

	$id	= JL::getVar('id', 0);

	// variable pour d&eacute;terminer quel <li> est en class="active"
	$active = -1;

	if($app == 'profil') {
		if($user->id > 0 && (preg_match('/^step/', $action) || $action=="notification")) {
			$active = 1;
			$menu = 1;
			if($action != 'step1' && $action != 'step1submit' && $action != 'notification'){
				$ss_menu = 1;
			}
		} elseif($action == 'panel') {
			$active = 0;
		}
	} elseif($app == 'message') {
		$active = 1;
		$menu = 1;
		$ss_menu = 2;
	} elseif($app == 'flbl') {
		$active = 1;
		$menu = 1;
		$ss_menu = 3;
	} elseif($app == 'search') {
		if($action=='search_online') {
			/*if($_GET['lang']=='fr'){
				$active = 2;
				$menu = 2;
			}else{*/
				$active = 6;
			//}
		} else {
			$active = 2;
			$menu = 2;
		}
	}  elseif($app == 'chat') {
		$active = 3;
	} elseif($app == 'groupe') {
		$active = 4;
		$menu = 3;
	} elseif($app == 'points') {
		$active = 5;
		$menu = 4;
	}  elseif($app == 'expert') {
		/*$active = 6;
		$menu = 5;
		$id = JL::getVar('id','');
		if($id){
			$ss_menu = 4;
		}*/
	} elseif($app == 'abonnement') {
		$active = 7;
		$menu = 6;
	} elseif($app == 'contenu' && $id=13) {
		$active = 8;
	}

?>

<table class="menu" cellpadding="0" cellspacing="0" width="100%">
	<tr>
	
		<td <? if($active == 0) {?>class="active"<? } ?>><a href="<? echo $user->id ? JL::url('index.php?app=profil&action=panel'.'&'.$langue) : SITE_URL.'?'.$langue; ?>" title="<?php echo $lang_mod["Accueil"];?>"><?php echo $lang_mod["Accueil"];?></a></td>

		<td <? if($active == 1) {?>class="active"<? } ?>><a href="<? echo JL::url('index.php?app=profil&action=step1'.'&'.$langue); ?>" title="<?php echo $lang_mod["MonCompte"];?>"><?php echo $lang_mod["MonCompte"];?></a></td>
		
		<td <? if($active == 2) {?>class="active"<? } ?>><a href="<? echo JL::url('index.php?app=search&action=search'.'&'.$langue); ?>" title="<?php echo $lang_mod["Recherche"];?>"><?php echo $lang_mod["Recherche"];?></a></td>
		
		<td <? if($active == 3) {?>class="active"<? } ?>><a href="<? if($user->id) { ?>javascript:windowOpen('ParentSoloChat','<? echo JL::url(SITE_URL.'/chat2/chat.php?'.$langue); ?>','810px','610px');<? } else { echo JL::url('index.php?app=profil&action=inscription&'.$langue); } ?>" title="<?php echo $lang_mod["Chat"];?>"><?php echo $lang_mod["Chat"];?></a></td>
		
		<td <? if($active == 4) {?>class="active"<? } ?>><a href="<? echo JL::url('index.php?app=groupe&action=list&groupe_type=all'.'&'.$langue); ?>" title="<?php echo $lang_mod["Groupes"];?>"><?php echo $lang_mod["Groupes"];?></a></td>
		
		<td <? if($active == 5) {?>class="active"<? } ?>><a href="<? echo JL::url('index.php?app=points&action=mespoints'.'&'.$langue); ?>" title="<?php echo $lang_mod["Solofleurs"];?>"><?php echo $lang_mod["Solofleurs"];?></a></td>
		
		<? 
			/*
			if($_GET['lang']=='fr'){?>
				<td <? if($active == 6) {?>class="active"<? } ?>><a href="<? echo JL::url('index.php?app=expert'.'&'.$langue); ?>" title="<?php echo $lang_mod["Experts"];?>"><?php echo $lang_mod["Experts"];?></a></td>
		<? }else{ 
			*/ 
		?>
				<td <? if($active == 6) {?>class="active"<? } ?>><a href="<? echo JL::url('index.php?app=search&action=search_online'.'&'.$langue); ?>" title="<?php echo $lang_mod["EnLigne"];?>"><?php echo $lang_mod["EnLigne"];?></a></td>
		<?// } ?>
		
		<td <? if($active == 7) {?>class="active"<? } ?>><a href="<? echo JL::url('index.php?app=abonnement&action=tarifs'.'&'.$langue); ?>" title="<?php echo $lang_mod["Abonnement"];?>"><?php echo $lang_mod["Abonnement"];?></a></td>

		<td <? if($active == 8) {?>class="active"<? } ?>><a href="<? echo JL::url('index.php?app=contenu&id=13'.'&'.$langue); ?>" title="<?php echo $lang_mod["Aide"];?>"><?php echo $lang_mod["Aide"];?></a></td>
	</tr>
</table>

<?

if($menu){
	?>
	<table class="menu_cat" cellpadding="0" cellspacing="0">
		<tr>
	<?
		switch($menu){
			case 6:
				?>
					<td><a href="<? echo JL::url('index.php?app=abonnement&action=infos&'.$langue); ?>" title="<? echo $lang_mod["Informations"]; ?>"><? echo $lang_mod["Informations"]; ?></a></td>
					<td><a href="<? echo JL::url('index.php?app=abonnement&action=tarifs&'.$langue); ?>" title="<? echo $lang_mod["Abonnez-vous"]; ?>"><? echo $lang_mod["Abonnez-vous"]; ?></a></td>			
				<?
			break;
			
			case 5:
				/*	$query = "SELECT id, specialite, titre"
					." FROM expert"
					." WHERE active=1";
					$experts = $db -> loadObjectList($query);
					
					foreach($experts as $row){
				?>
					<td><a href="<? echo JL::url('index.php?app=expert&action=expert&id='.$row->id.'&lang='.$_GET['lang']); ?>" title="<? echo $row->specialite.": ".$row->titre; ?>"><? echo $row->specialite.": ".$row->titre; ?></a></td>		
				<?
				}*/
			break;
		
			case 4:
				?>
					<td><a href="<? echo JL::url('index.php?app=points&action=info&'.$langue); ?>" title="<?php echo $lang_mod["Informations"];?>"><?php echo $lang_mod["Informations"];?></a></td>
					<td><a href="<? echo JL::url('index.php?app=points&action=reglement&'.$langue); ?>" title="<?php echo $lang_mod["Reglement"];?>"><?php echo $lang_mod["Reglement"];?></a></td>
					<td><a href="<? echo JL::url('index.php?app=points&action=cadeaux&'.$langue); ?>" title="<?php echo $lang_mod["Cadeau"];?>"><?php echo $lang_mod["Cadeau"];?></a></td>
					<td><a href="<? echo JL::url('index.php?app=points&action=bareme&'.$langue); ?>" title="<?php echo $lang_mod["Bareme"];?>"><?php echo $lang_mod["Bareme"];?></a></td>
					<td><a href="<? echo JL::url('index.php?app=points&action=classement&'.$langue); ?>" title="<?php echo $lang_mod["Classement"];?>"><?php echo $lang_mod["Classement"];?></a></td>
					<td><a href="<? echo JL::url('index.php?app=points&action=archives&'.$langue); ?>" title="<?php echo $lang_mod["Archives"];?>"><?php echo $lang_mod["Archives"];?></a></li>
					<td><a href="<? echo JL::url('index.php?app=points&action=mespoints&'.$langue); ?>" title="<?php echo $lang_mod["MesSolofleurs"];?>"><?php echo $lang_mod["MesSolofleurs"];?></a></td>
				<?
			break;
			
			case 3:
				?>
					<td><a href="<? echo JL::url('index.php?app=groupe&action=info&'.$langue); ?>" title="<? echo $lang_mod["Informations"]; ?>"><? echo $lang_mod["Informations"]; ?></a></td>
					<td><a href="<? echo JL::url('index.php?app=groupe&action=list&groupe_type=all&'.$langue); ?>" title="<? echo $lang_mod["TousLesGroupes"]; ?>"><? echo $lang_mod["TousLesGroupes"]; ?></a></td>
					<td><a href="<? echo JL::url('index.php?app=groupe&action=edit&'.$langue); ?>" title="<? echo $lang_mod["CreerUnGroupe"]; ?>"><? echo $lang_mod["CreerUnGroupe"]; ?></a></td>
					<td><a href="<? echo JL::url('index.php?app=groupe&action=list&groupe_type=created&'.$langue); ?>" title="<? echo $lang_mod["MesCreations"]; ?>"><? echo $lang_mod["MesCreations"]; ?></a></td>
					<td><a href="<? echo JL::url('index.php?app=groupe&action=list&groupe_type=joined&'.$langue); ?>" title="<? echo $lang_mod["GroupesRejoints"]; ?>"><? echo $lang_mod["GroupesRejoints"]; ?></a></td>
				<?
			break;
			
			case 2:
				?>
					<td><a href="<? echo JL::url('index.php?app=search&action=search_online&'.$langue); ?>" title="<? echo $lang_mod["EnLigne"]; ?>"><? echo $lang_mod["EnLigne"]; ?></a></td>
				<?
					if($user->genre=='h'){
				?>
						<td><a href="<? echo JL::url('index.php?app=search&action=search_last_inscription&'.$langue); ?>" title="<? echo $lang_mod["DerniersMamansInscrits"]; ?>"><? echo $lang_mod["DerniersMamansInscrits"]; ?></a></td>
				<?
					}elseif($user->genre=='f'){
				?>
						<td><a href="<? echo JL::url('index.php?app=search&action=search_last_inscription&'.$langue); ?>" title="<? echo $lang_mod["DerniersPapasInscrits"]; ?>"><? echo $lang_mod["DerniersPapasInscrits"]; ?></a></td>
				<?
					}
				?>
					<td><a href="<? echo JL::url('index.php?app=search&action=visits&'.$langue); ?>" title="<? echo $lang_mod["QuiAVisiteMonProfil"]; ?>"><? echo $lang_mod["QuiAVisiteMonProfil"]; ?></a></td>
					<td><a href="<? echo JL::url('index.php?app=search&action=search&'.$langue); ?>" title="<? echo $lang_mod["RechercheAvancee"]; ?>"><? echo $lang_mod["RechercheAvancee"]; ?></a></td>
				<?
			break;
			
			case 1:
			default:
				?>
					<td <? if($ss_menu == 1) {?>class="active"<? } ?>><a href="<? echo JL::url('index.php?app=profil&action=step2&'.$langue); ?>" title="<? echo $lang_mod["MonProfil"]; ?>"><? echo $lang_mod["MonProfil"]; ?></a></td>
					<td <? if($ss_menu == 3) {?>class="active"<? } ?>><a href="<? echo JL::url('index.php?app=flbl&action=list&list_type=1&'.$langue); ?>" title="<? echo $lang_mod["MesListes"]; ?>"><? echo $lang_mod["MesListes"]; ?></a></td>
					<td <? if($ss_menu == 2) {?>class="active"<? } ?>><a href="<? echo JL::url('index.php?app=message&action=inbox&'.$langue); ?>" title="<? echo $lang_mod["MesMails"]; ?>"><? echo $lang_mod["MesMails"]; ?></a></td>
					<td <? if($action == "step1" || $action == "step1submit") {?>class="active"<? } ?>><a href="<? echo JL::url('index.php?app=profil&action=step1&'.$langue); ?>" title="<? echo $lang_mod["ParametresCompte"]; ?>"><? echo $lang_mod["ParametresCompte"]; ?></a></td>
					<td <? if($action == "notification" || $action == "notificationsubmit") {?>class="active"<? } ?>><a href="<? echo JL::url('index.php?app=profil&action=notification&'.$langue); ?>" title="<? echo $lang_mod["Notifications"]; ?>"><? echo $lang_mod["Notifications"]; ?></a></td>
				<?
			break;
		}
	?>	
		</tr>
	</table>
	<?
	
}

if($ss_menu){
	?>
	<table class="ss_menu_cat" cellpadding="0" cellspacing="0">
		<tr>
	<?
		switch($ss_menu){
			
			
			case 4:
				/*?>
					<td><a href="<? echo JL::url('index.php?app=expert&action=expert&id='.$id.'&lang='.$_GET['lang']); ?>" title="<? echo $lang_mod["PoserUneQuestion"]; ?>"><? echo $lang_mod["PoserUneQuestion"]; ?></a></td>
					<td><a href="<? echo JL::url('index.php?app=expert&action=questions&id='.$id.'&lang='.$_GET['lang']); ?>" title="<? echo $lang_mod["ToutesLesQuestionsTraitees"]; ?>"><? echo $lang_mod["ToutesLesQuestionsTraitees"]; ?></a></td>
				<?*/
			break;
			
			
			case 3:
				?>
					<td><a href="<? echo JL::url('index.php?app=flbl&action=list&list_type=1&'.$langue); ?>" title="<? echo $lang_mod["Favoris"]; ?>"><? echo $lang_mod["Favoris"]; ?></a></td>
					<td><a href="<? echo JL::url('index.php?app=flbl&action=list&list_type=0&'.$langue); ?>" title="<? echo $lang_mod["ListeNoire"]; ?>"><? echo $lang_mod["ListeNoire"]; ?></a></td>
				<?
			break;
			
			case 2:
				?>
					<td><a href="<? echo JL::url('index.php?app=message&action=inbox&'.$langue); ?>" title="<? echo $lang_mod["BoiteReception"]; ?>"><? echo $lang_mod["BoiteReception"]; ?></a></td>
					<td><a href="<? echo JL::url('index.php?app=message&action=sent&'.$langue); ?>" title="<? echo $lang_mod["Envois"]; ?>"><? echo $lang_mod["Envois"]; ?></a></td>
					<td><a href="<? echo JL::url('index.php?app=message&action=archive&'.$langue); ?>" title="<? echo $lang_mod["Archives"]; ?>"><? echo $lang_mod["Archives"]; ?></a></td>
					<td><a href="<? echo JL::url('index.php?app=message&action=trash&'.$langue); ?>" title="<? echo $lang_mod["Corbeille"]; ?>"><? echo $lang_mod["Corbeille"]; ?></a></td>
				<?
			break;
			
			case 1:
			default:
				?>
					<td><a href="<? echo JL::url('index.php?app=profil&action=step2&'.$langue); ?>" title="<? echo $lang_mod["MesPhotos"]; ?>"><? echo $lang_mod["MesPhotos"]; ?></a></td>
					<td><a href="<? echo JL::url('index.php?app=profil&action=step3&'.$langue); ?>" title="<? echo $lang_mod["MonAnnonce"]; ?>"><? echo $lang_mod["MonAnnonce"]; ?></a></td>
					<td><a href="<? echo JL::url('index.php?app=profil&action=step4&'.$langue); ?>" title="<? echo $lang_mod["MaDescription"]; ?>"><? echo $lang_mod["MaDescription"]; ?></a></td>
					<td><a href="<? echo JL::url('index.php?app=profil&action=step5&'.$langue); ?>" title="<? echo $lang_mod["MesEnfants"]; ?>"><? echo $lang_mod["MesEnfants"]; ?></a></td>
				<?
			break;
		}
	?>	
		</tr>
	</table>
	<?
	
}
